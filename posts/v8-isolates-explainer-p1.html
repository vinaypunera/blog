<!DOCTYPE html><!--IkZUDQEwMnrXIQxr3RMHp--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/4cf2300e9c8272f7-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="/illustrations/v8-isolate-architecture.svg"/><link rel="stylesheet" href="/_next/static/css/15ff950965ac935a.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-ed9be09274cd6fae.js"/><script src="/_next/static/chunks/4bd1b696-182b6b13bdad92e3.js" async=""></script><script src="/_next/static/chunks/1255-2c359fbdcbebe457.js" async=""></script><script src="/_next/static/chunks/main-app-1d81304c46a54c0f.js" async=""></script><script src="/_next/static/chunks/2201-6f6797369dbd70e4.js" async=""></script><script src="/_next/static/chunks/8537-401cf79acecfff54.js" async=""></script><script src="/_next/static/chunks/7394-6015a1eac3455248.js" async=""></script><script src="/_next/static/chunks/9227-702d20ddd5580687.js" async=""></script><script src="/_next/static/chunks/app/layout-5abbe08916af3e92.js" async=""></script><script src="/_next/static/chunks/1356-1fb83b63ccda55b7.js" async=""></script><script src="/_next/static/chunks/app/posts/%5Bslug%5D/page-16bd337e30c17cd7.js" async=""></script><meta name="next-size-adjust" content=""/><title>Deep Dive into V8 and V8 Isolates: The Engine and the Sandbox (Part 1)</title><meta name="description" content="V8 Isolates are the lightweight, secure containers that power modern JavaScript execution in Chrome and Node.js. This first part explains the V8 engine, the concept of memory isolation, and how to build a basic secure sandbox using the isolated-vm library in Node.js."/><meta property="og:title" content="Deep Dive into V8 and V8 Isolates: The Engine and the Sandbox (Part 1)"/><meta property="og:description" content="V8 Isolates are the lightweight, secure containers that power modern JavaScript execution in Chrome and Node.js. This first part explains the V8 engine, the concept of memory isolation, and how to build a basic secure sandbox using the isolated-vm library in Node.js."/><meta property="og:image" content="https://vinay.stealthbit.in/illustrations/v8-isolate-architecture.svg"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image:alt" content="An illustration of a main computing structure acting as a host, with several interior rooms that are clearly labeled as &#x27;Isolates&#x27; and sealed off from each other, symbolizing concurrent execution with strong separation."/><meta property="og:type" content="article"/><meta property="article:published_time" content="2025-11-18T00:00:00.000Z"/><meta property="article:tag" content="v8"/><meta property="article:tag" content="v8-isolate"/><meta property="article:tag" content="javascript"/><meta property="article:tag" content="nodejs"/><meta property="article:tag" content="sandboxing"/><meta property="article:tag" content="isolated-vm"/><meta property="article:tag" content="concurrency"/><meta property="article:tag" content="memory-isolation"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Deep Dive into V8 and V8 Isolates: The Engine and the Sandbox (Part 1)"/><meta name="twitter:description" content="V8 Isolates are the lightweight, secure containers that power modern JavaScript execution in Chrome and Node.js. This first part explains the V8 engine, the concept of memory isolation, and how to build a basic secure sandbox using the isolated-vm library in Node.js."/><meta name="twitter:image" content="https://vinay.stealthbit.in/illustrations/v8-isolate-architecture.svg"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><link rel="icon" href="/icon.svg?b0cfa693b1818954" type="image/svg+xml" sizes="any"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_188709 __variable_9a8899 min-h-screen bg-background font-sans text-foreground"><div hidden=""><!--$--><!--/$--></div><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><style>#nprogress{pointer-events:none}#nprogress .bar{background:hsl(var(--accent));position:fixed;z-index:1600;top: 0;left:0;width:100%;height:3px}#nprogress .peg{display:block;position:absolute;right:0;width:100px;height:100%;box-shadow:0 0 10px hsl(var(--accent)),0 0 5px hsl(var(--accent));opacity:1;-webkit-transform:rotate(3deg) translate(0px,-4px);-ms-transform:rotate(3deg) translate(0px,-4px);transform:rotate(3deg) translate(0px,-4px)}#nprogress .spinner{display:block;position:fixed;z-index:1600;top: 15px;right:15px}#nprogress .spinner-icon{width:18px;height:18px;box-sizing:border-box;border:2px solid transparent;border-top-color:hsl(var(--accent));border-left-color:hsl(var(--accent));border-radius:50%;-webkit-animation:nprogress-spinner 400ms linear infinite;animation:nprogress-spinner 400ms linear infinite}.nprogress-custom-parent{overflow:hidden;position:relative}.nprogress-custom-parent #nprogress .bar,.nprogress-custom-parent #nprogress .spinner{position:absolute}@-webkit-keyframes nprogress-spinner{0%{-webkit-transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg)}}@keyframes nprogress-spinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}</style><div class="pointer-events-none fixed bottom-6 right-6 z-50 flex flex-col items-end gap-3 sm:bottom-10 sm:right-10"><div class="pointer-events-auto flex flex-col items-end gap-3"><div class="flex items-center gap-3"><div class="pointer-events-auto flex items-center rounded-full bg-background/95 shadow-xl backdrop-blur-sm ring-1 ring-border/50 floating-player-glow"><button type="button" class="flex h-14 w-14 shrink-0 items-center justify-center rounded-full bg-accent text-accent-foreground shadow-2xl transition hover:bg-accent/90" aria-label="Open navigation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-6 w-6" aria-hidden="true"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button></div></div></div></div><div class="flex min-h-screen flex-col"><main class="flex-1"><div class="pointer-events-none fixed top-0 left-0 z-40 h-1 w-full bg-transparent"><div class="h-full bg-accent transition-[width] duration-200" style="width:0%" role="presentation" aria-hidden="true"></div></div><article class="mx-auto flex w-full max-w-3xl flex-col gap-10 px-6 pt-12 pb-28"><nav aria-label="Breadcrumb"><ol class="flex flex-wrap items-center gap-1 text-sm text-muted-foreground"><li class="flex items-center gap-1"><a class="hover:text-accent" href="/">Home</a><span aria-hidden="true">/</span></li><li class="flex items-center gap-1"><a class="hover:text-accent" href="/#posts">Posts</a><span aria-hidden="true">/</span></li><li class="flex items-center gap-1"><a class="hover:text-accent" href="/posts/v8-isolates-explainer-p1">Deep Dive into V8 and V8 Isolates: The Engine and the Sandbox (Part 1)</a></li></ol></nav><header class="space-y-4"><p class="text-xs uppercase tracking-[0.3em] text-accent">Article</p><h1 class="text-3xl font-semibold leading-tight sm:text-4xl">Deep Dive into V8 and V8 Isolates: The Engine and the Sandbox (Part 1)</h1><div class="flex flex-wrap items-center gap-3 text-sm text-muted-foreground"><time dateTime="2025-11-18T00:00:00.000Z">Nov 18, 2025</time><span aria-hidden="true">‚Ä¢</span><span>10 min read</span><span aria-hidden="true">‚Ä¢</span><a class="font-medium text-foreground transition-colors hover:text-accent" href="/about">Vinay Punera</a></div><div class="flex flex-wrap gap-2"><span class="rounded-full border border-border px-3 py-1 text-xs uppercase tracking-wide">v8</span><span class="rounded-full border border-border px-3 py-1 text-xs uppercase tracking-wide">v8-isolate</span><span class="rounded-full border border-border px-3 py-1 text-xs uppercase tracking-wide">javascript</span><span class="rounded-full border border-border px-3 py-1 text-xs uppercase tracking-wide">nodejs</span><span class="rounded-full border border-border px-3 py-1 text-xs uppercase tracking-wide">sandboxing</span><span class="rounded-full border border-border px-3 py-1 text-xs uppercase tracking-wide">isolated-vm</span><span class="rounded-full border border-border px-3 py-1 text-xs uppercase tracking-wide">concurrency</span><span class="rounded-full border border-border px-3 py-1 text-xs uppercase tracking-wide">memory-isolation</span></div></header><section aria-label="Listen to this post" class="rounded-3xl border border-border bg-muted/50 p-4 shadow-sm transition-all"><div class="flex items-center gap-3"><button type="button" aria-label="Play narration" class="flex h-11 w-11 shrink-0 items-center justify-center rounded-full bg-accent text-white shadow-sm transition hover:bg-accent/90"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play h-4 w-4 transition" aria-hidden="true"><polygon points="6 3 20 12 6 21 6 3"></polygon></svg></button><div class="flex min-w-0 flex-1 flex-col gap-1"><span class="flex items-center gap-2 text-[11px] font-semibold uppercase tracking-[0.3em] text-muted-foreground">Listen</span><span class="truncate text-sm font-medium text-foreground">AI narration</span></div></div><div class="mt-3 flex items-center gap-2"><span class="shrink-0 text-xs tabular-nums text-muted-foreground">0:00</span><div class="relative h-6 flex-1 select-none focus-within:outline-none"><div class="absolute left-0 right-0 top-1/2 h-1 -translate-y-1/2 overflow-hidden rounded-full bg-border"><div class="h-full rounded-full bg-accent transition-all" style="width:0%"></div></div><input type="range" min="0" max="295" step="any" aria-label="Scrub through the narration" aria-valuetext="0:00 of 04:55" disabled="" class="absolute inset-0 m-0 h-full w-full cursor-pointer appearance-none bg-transparent disabled:cursor-not-allowed [&amp;::-webkit-slider-runnable-track]:appearance-none [&amp;::-moz-range-track]:bg-transparent [&amp;::-webkit-slider-thumb]:appearance-none [&amp;::-webkit-slider-thumb]:h-4 [&amp;::-webkit-slider-thumb]:w-4 [&amp;::-webkit-slider-thumb]:rounded-full [&amp;::-webkit-slider-thumb]:bg-white [&amp;::-webkit-slider-thumb]:shadow-[0_0_0.75rem_hsl(var(--accent)_/_0.25)] [&amp;::-webkit-slider-thumb]:transition [&amp;::-moz-range-thumb]:h-4 [&amp;::-moz-range-thumb]:w-4 [&amp;::-moz-range-thumb]:appearance-none [&amp;::-moz-range-thumb]:rounded-full [&amp;::-moz-range-thumb]:border-0 [&amp;::-moz-range-thumb]:bg-white [&amp;::-moz-range-thumb]:shadow-[0_0_0.75rem_hsl(var(--accent)_/_0.25)] [&amp;::-moz-range-thumb]:transition" value="0"/></div><span class="shrink-0 text-xs tabular-nums text-muted-foreground">04:55</span></div></section><dialog class="lightbox-dialog"><div class="lightbox-inner"><button class="lightbox-close" aria-label="Close lightbox"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x h-6 w-6"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="lightbox-hint"><span class="text-xs text-white/60">Click/Touch anywhere to close</span></div><div class="lightbox-content"></div></div></dialog><div class="overflow-hidden rounded-3xl border border-border bg-muted"><img alt="An illustration of a main computing structure acting as a host, with several interior rooms that are clearly labeled as &#x27;Isolates&#x27; and sealed off from each other, symbolizing concurrent execution with strong separation." width="1200" height="630" decoding="async" data-nimg="1" class="h-auto w-full object-cover" style="color:transparent" src="/illustrations/v8-isolate-architecture.svg"/></div><div class="prose prose-neutral dark:prose-invert max-w-none"><div><h1>Part 1: Deep Dive into V8 and V8 Isolates - The Engine and the Sandbox</h1>
<p>Imagine you need to run code you don't fully trust - maybe it's user-submitted plugins, third-party extensions, or dynamically generated scripts. What's stopping that code from reading your environment variables, accessing your file system, or consuming all your server's resources?</p>
<p>This is the central challenge of modern computing: <strong>How do you run untrusted code safely?</strong></p>
<p>You could use Docker containers, but their 5-second "cold start" would kill your user experience. Virtual Machines are even slower. You need something that can create a <strong>perfectly secure sandbox in less than 5 milliseconds</strong>.</p>
<p>Enter the <strong>V8 Isolate</strong> - the battle-tested technology that powers Google Chrome and makes it possible to run untrusted code at massive scale, securely. This is the same technology behind platforms like <strong>Cloudflare Workers</strong> and <strong>Deno Deploy</strong>.</p>
<p>This guide explains what V8 Isolates are, how they work, and how you can use them to build secure, high-performance applications.</p>
<hr>
<h2>üèéÔ∏è What is V8? The Engine That Powers JavaScript</h2>
<p>Before we talk about <em>isolates</em>, let's understand <strong>V8</strong> itself.</p>
<p>V8 is Google's open-source JavaScript and WebAssembly engine, written in C++. Think of it as the high-performance engine inside cars like Google Chrome and Node.js. Its job is to take human-readable JavaScript and compile it into lightning-fast machine code for your computer's processor.</p>
<p>Every <code>console.log("hello")</code> you write goes through V8.</p>
<p>V8 is everywhere:</p>
<ul>
<li><strong>Google Chrome</strong> (browser)</li>
<li><strong>Node.js</strong> (server)</li>
<li><strong>Deno</strong> (modern runtime)</li>
<li><strong>Cloudflare Workers</strong> (edge computing)</li>
</ul>
<figure class="mermaid-diagram"><img src="/diagrams/v8-isolates-explainer-p1-diagram-1.svg" alt="Diagram 1"></figure>
<h3>How V8 Achieves Speed: JIT Compilation</h3>
<p>V8's secret weapon is <strong>Just-In-Time (JIT) Compilation</strong> - a clever two-stage process:</p>
<p><strong>Stage 1: Ignition (The Fast Starter)</strong></p>
<ul>
<li>When your code first runs, V8's interpreter <strong>Ignition</strong> executes it immediately</li>
<li>This gives you instant startup - no waiting for compilation</li>
<li>Think of it as a speed reader that gets the job done quickly</li>
</ul>
<p><strong>Stage 2: Turbofan (The Optimizer)</strong></p>
<ul>
<li>Ignition watches your code as it runs</li>
<li>If it sees a function being called repeatedly (a "hot function"), it calls in the specialist: <strong>Turbofan</strong></li>
<li>Turbofan is V8's optimizing compiler - it takes that hot code and recompiles it into hyper-optimized machine code</li>
<li>The result? Lightning-fast execution for frequently-used code</li>
</ul>
<p>This two-stage approach gives you the best of both worlds: <strong>fast startup</strong> and <strong>maximum sustained performance</strong>.</p>
<figure class="mermaid-diagram"><img src="/diagrams/v8-isolates-explainer-p1-diagram-2.svg" alt="Diagram 2"></figure>
<hr>
<h2>üö™ What is a V8 Isolate? The "Sealed Room" Analogy</h2>
<p>Now we get to the most important concept. If the V8 Engine is the motor, the <strong>V8 Isolate</strong> is the <strong>perfectly sealed, soundproof room</strong> in which that motor runs.</p>
<p>An <strong>Isolate</strong> is an isolated, independent instance of the V8 engine.</p>
<p>Think of it literally as a <strong>sealed room</strong>:</p>
<ul>
<li>It has its own <strong>private memory</strong> (its own heap)</li>
<li>It has its own <strong>garbage collector</strong> (its own cleaning crew)</li>
<li>It has <strong>zero access</strong> to the outside world</li>
<li>The walls are soundproof and airtight</li>
</ul>
<p>A person in one room <strong>cannot</strong> see, hear, or interact with a person in another room. If a program in one isolate crashes, it only affects that one "room" - the rest of your application keeps running perfectly.</p>
<h3>You Use This Every Day: Chrome Tabs</h3>
<p>You already use this technology daily. Every tab in Chrome runs in its own isolate.</p>
<p>When you have Gmail open in one tab and your bank in another, Gmail's JavaScript <strong>cannot</strong> access your banking tab's memory. If a malicious website crashes in tab 3, it doesn't take down Gmail and your bank.</p>
<p>This is V8 Isolates in action.</p>
<figure class="mermaid-diagram"><img src="/diagrams/v8-isolates-explainer-p1-diagram-3.svg" alt="Diagram 3"></figure>
<h3>What Makes Each Isolate "Sealed"?</h3>
<p>Each isolate has its own:</p>
<ol>
<li>
<p><strong>Dedicated Heap Memory</strong> ‚≠ê Most Important</p>
<ul>
<li>Each isolate has its own private memory space</li>
<li>Code in Isolate A <strong>cannot</strong> read or write memory from Isolate B</li>
<li>This is the foundation of security</li>
</ul>
</li>
<li>
<p><strong>Independent Garbage Collector</strong></p>
<ul>
<li>Each isolate cleans up its own memory</li>
<li>Memory cleanup in one isolate doesn't slow down others</li>
</ul>
</li>
<li>
<p><strong>Separate Global Scope</strong></p>
<ul>
<li>Each isolate has its own <code>global</code> object</li>
<li>Built-in objects like <code>Math</code>, <code>JSON</code> are separate instances</li>
</ul>
</li>
</ol>
<h2>‚ö° Why Isolates Changed Everything: The Performance Revolution</h2>
<p>For years, we used <strong>Virtual Machines</strong> and <strong>Docker containers</strong> to isolate code. But they're heavy:</p>





























<table><thead><tr><th>Technology</th><th>Startup Time</th><th>Memory Overhead</th><th>Good For</th></tr></thead><tbody><tr><td><strong>Virtual Machines</strong></td><td>Seconds</td><td>Very Heavy</td><td>Full OS isolation</td></tr><tr><td><strong>Docker Containers</strong></td><td>500ms - 10s</td><td>Medium</td><td>Microservices</td></tr><tr><td><strong>V8 Isolates</strong></td><td><strong>&#x3C; 5ms</strong></td><td>Very Light</td><td>Code execution</td></tr></tbody></table>
<p>V8 Isolates are <strong>micro-sandboxes</strong>:</p>
<ul>
<li>No operating system</li>
<li>No filesystem</li>
<li>No networking</li>
<li>No environment variables</li>
</ul>
<p>Just pure JavaScript execution.</p>
<p>This breakthrough enabled the <strong>serverless revolution</strong>. Platforms like <strong>Cloudflare Workers</strong> can run code from thousands of customers on the same machine, all completely isolated, with <strong>zero cold start</strong>. They spin up a new isolate for each request in under 5 milliseconds.</p>
<figure class="mermaid-diagram"><img src="/diagrams/v8-isolates-explainer-p1-diagram-4.svg" alt="Diagram 4"></figure>
<hr>
<h2>üß™ What Happens Inside an Isolate?</h2>
<p>Inside an isolate, you get a clean, empty JavaScript world:</p>
<figure data-rehype-pretty-code-figure=""><pre tabindex="0" data-language="javascript" data-theme="github-dark-dimmed github-light"><code data-language="javascript" data-theme="github-dark-dimmed github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">let</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> a </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 10</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">;</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">let</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> b </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 20</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">;</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">a </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">+</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> b; </span><span style="--shiki-dark:#768390;--shiki-light:#6A737D">// Works fine!</span></span><button type="button" title="Copy code" aria-label="Copy code" data="let a = 10;
let b = 20;
a + b; // Works fine!" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 2000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}</style></code></pre></figure>
<p>But no access to:</p>
<ul>
<li>‚ùå <code>fs</code> (file system)</li>
<li>‚ùå <code>process</code> (environment variables, exit)</li>
<li>‚ùå <code>require</code> (importing modules)</li>
<li>‚ùå Any Node.js internals</li>
</ul>
<p>Unless <strong>you explicitly expose them</strong> using a secure bridge.</p>
<h2>üõ†Ô∏è Practical Guide: Building Sandboxes with <code>isolated-vm</code></h2>
<p>While V8 is a C++ library, the <strong><code>isolated-vm</code></strong> library for Node.js gives you direct access to this power.</p>
<p>First, install it:</p>
<figure data-rehype-pretty-code-figure=""><pre tabindex="0" data-language="bash" data-theme="github-dark-dimmed github-light"><code data-language="bash" data-theme="github-dark-dimmed github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#6F42C1">npm</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> install</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> isolated-vm</span></span><button type="button" title="Copy code" aria-label="Copy code" data="npm install isolated-vm" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 2000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}</style></code></pre></figure>
<p>The fundamental security rule is simple: <strong>The isolate is a jail with zero access to your host system by default.</strong></p>
<h3>Example 1: Your First Sandbox with Time and Memory Limits</h3>
<p>This example shows how to create a sandbox with strict resource limits. The code inside <strong>cannot</strong> run forever or consume unlimited memory.</p>
<figure data-rehype-pretty-code-figure=""><pre tabindex="0" data-language="javascript" data-theme="github-dark-dimmed github-light"><code data-language="javascript" data-theme="github-dark-dimmed github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">const</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> ivm</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1"> require</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">'isolated-vm'</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">async</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> function</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1"> runUntrustedScript</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">code</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">) {</span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">    // 1. Create a new Isolate with resource limits</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    const</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> isolate</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> new</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> ivm.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">Isolate</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">({ </span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">        memoryLimit: </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">128</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#768390;--shiki-light:#6A737D">// Max RAM consumption: 128MB</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    }); </span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    const</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> context</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> await</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> isolate.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">createContext</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">();</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">    // 2. Compile the script (LLM-generated or user-submitted code)</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    const</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> script</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> await</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> isolate.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">compileScript</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(code);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    try</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> {</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">        console.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">log</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">'--- Running Script in Sandbox ---'</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">);</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">        </span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">        // 3. Execute with a 1-second timeout</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">        const</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> result</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> await</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> script.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">run</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(context, { timeout: </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">1000</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> }); </span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">        </span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">        console.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">log</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">'Result:'</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, result);</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    } </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">catch</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> (e) {</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">        console.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">error</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">'Execution Failed:'</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, e.message); </span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    } </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">finally</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> {</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">        isolate.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">dispose</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(); </span><span style="--shiki-dark:#768390;--shiki-light:#6A737D">// Always clean up the isolate</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    }</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">// Case 1: Safe code</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">const</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> safeCode</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> `10 + 20;`</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">// Case 2: Time-out code (infinite loop)</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">const</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> maliciousCode</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> `while(true) {}`</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">// Case 3: Forbidden access attempt</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">const</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> securityRiskCode</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> `process.env.SECRET_API_KEY;`</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">runUntrustedScript</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(safeCode); </span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">// Output: Result: 30</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">runUntrustedScript</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(maliciousCode); </span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">// Output: Execution Failed: Error: Script execution timed out.</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">runUntrustedScript</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(securityRiskCode);</span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">// Output: Execution Failed: ReferenceError: process is not defined </span></span><button type="button" title="Copy code" aria-label="Copy code" data="const ivm = require(&#x27;isolated-vm&#x27;);

async function runUntrustedScript(code) {
    // 1. Create a new Isolate with resource limits
    const isolate = new ivm.Isolate({ 
        memoryLimit: 128, // Max RAM consumption: 128MB
    }); 
    const context = await isolate.createContext();

    // 2. Compile the script (LLM-generated or user-submitted code)
    const script = await isolate.compileScript(code);

    try {
        console.log(&#x27;--- Running Script in Sandbox ---&#x27;);
        
        // 3. Execute with a 1-second timeout
        const result = await script.run(context, { timeout: 1000 }); 
        
        console.log(&#x27;Result:&#x27;, result);
    } catch (e) {
        console.error(&#x27;Execution Failed:&#x27;, e.message); 
    } finally {
        isolate.dispose(); // Always clean up the isolate
    }
}

// Case 1: Safe code
const safeCode = &#x60;10 + 20;&#x60;;

// Case 2: Time-out code (infinite loop)
const maliciousCode = &#x60;while(true) {}&#x60;;

// Case 3: Forbidden access attempt
const securityRiskCode = &#x60;process.env.SECRET_API_KEY;&#x60;;

runUntrustedScript(safeCode); 
// Output: Result: 30

runUntrustedScript(maliciousCode); 
// Output: Execution Failed: Error: Script execution timed out.

runUntrustedScript(securityRiskCode);
// Output: Execution Failed: ReferenceError: process is not defined " class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 2000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}</style></code></pre></figure>
<p><strong>What just happened?</strong></p>
<ul>
<li>The infinite loop was killed after 1 second ‚úÖ</li>
<li>The attempt to access <code>process.env</code> failed because <code>process</code> doesn't exist in the isolate ‚úÖ</li>
<li>Your secrets are safe ‚úÖ</li>
</ul>
<h2>üîî The Challenge: Making Isolates Useful</h2>
<p>Okay, our isolate is perfectly secure. But it's <em>too</em> secure. It's a jail cell with nothing inside. How can the code do anything useful if it can't call a database or an API?</p>
<h3>The Solution: The "Bank Teller Window" Pattern</h3>
<p>Think of it like a bank:</p>
<ul>
<li><strong>Your Code (The Vault):</strong> Holds all your secrets - API keys, database passwords</li>
<li><strong>The Isolate (The Lobby):</strong> Where untrusted code runs</li>
<li><strong>The Bridge (The Teller Window):</strong> A secure pass-through that takes requests but never exposes the vault</li>
</ul>
<p>The untrusted code can "ring the bell" (call a function), and your secure code handles it behind the scenes, passing back only the result.</p>
<figure class="mermaid-diagram"><img src="/diagrams/v8-isolates-explainer-p1-diagram-5.svg" alt="Diagram 5"></figure>
<h3>Example 2: The "Bank Teller" in Action</h3>
<p>Let's build a secure database proxy. The untrusted code can query the database, but it <strong>never</strong> sees your connection string.</p>
<figure data-rehype-pretty-code-figure=""><pre tabindex="0" data-language="javascript" data-theme="github-dark-dimmed github-light"><code data-language="javascript" data-theme="github-dark-dimmed github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">const</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> ivm</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1"> require</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">'isolated-vm'</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">// --- HOST PROCESS (SECURE) ---</span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">// This function runs on the secure host - secrets are protected here</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">function</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1"> secureDbQuery</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">sql</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">) {</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    const</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> MY_DB_PASSWORD</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> 'super-secret-password-123'</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">;</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    console.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">log</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">`[üîê Vault] Running query with password: ${</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">sql</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">}`</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">);</span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">    // Real database query happens here with your credentials</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    return</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> new</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> ivm.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">ExternalCopy</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">({ rows: [{ id: </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">1</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, name: </span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">"Alice"</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> }], count: </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">1</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> }).</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">copyInto</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">();</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">async</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> function</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1"> runWithDatabaseAccess</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">() {</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    const</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> isolate</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> new</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> ivm.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">Isolate</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">({ memoryLimit: </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">128</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> });</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    const</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> context</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> await</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> isolate.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">createContext</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">();</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    </span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">    // 1. Inject the secure query function</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    const</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> queryRef</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> new</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> ivm.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">Reference</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(secureDbQuery);</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    await</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> context.global.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">set</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">'_queryHost'</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, queryRef);</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    </span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">    // 2. Create a simple wrapper inside the isolate</span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">    // This hides the complex applySync API and makes the function easy to call</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    await</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> context.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">eval</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">`</span></span>
<span data-line=""><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">        globalThis.db = {</span></span>
<span data-line=""><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">            query: function(sql) {</span></span>
<span data-line=""><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">                return _queryHost.applySync(undefined, [sql], { arguments: { copy: true } });</span></span>
<span data-line=""><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">            }</span></span>
<span data-line=""><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">        };</span></span>
<span data-line=""><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">    `</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">);</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    </span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">    // 3. Run the untrusted code</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    const</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> script</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> await</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> isolate.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">compileScript</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">`</span></span>
<span data-line=""><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">        // This code can call db.query, but it NEVER sees your password</span></span>
<span data-line=""><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">        const data = db.query("SELECT * FROM users WHERE active = true");</span></span>
<span data-line=""><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">        'Found ' + data.count + ' active users.';</span></span>
<span data-line=""><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">    `</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">);</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    </span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    const</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> result</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> await</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> script.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">run</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(context, { timeout: </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">1000</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> });</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    console.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">log</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">'üì§ Result returned to caller:'</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, result);</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    </span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    isolate.</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">dispose</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">();</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">// Call the function</span></span>
<span data-line=""><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1">runWithDatabaseAccess</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">();</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">/*</span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">Output:</span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">[üîê Vault] Running query with password: SELECT * FROM users WHERE active = true</span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">üì§ Result returned to caller: Found 1 active users.</span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">*/</span></span><button type="button" title="Copy code" aria-label="Copy code" data="const ivm = require(&#x27;isolated-vm&#x27;);

// --- HOST PROCESS (SECURE) ---
// This function runs on the secure host - secrets are protected here
function secureDbQuery(sql) {
    const MY_DB_PASSWORD = &#x27;super-secret-password-123&#x27;;
    console.log(&#x60;[üîê Vault] Running query with password: ${sql}&#x60;);
    // Real database query happens here with your credentials
    return new ivm.ExternalCopy({ rows: [{ id: 1, name: &#x22;Alice&#x22; }], count: 1 }).copyInto();
}

async function runWithDatabaseAccess() {
    const isolate = new ivm.Isolate({ memoryLimit: 128 });
    const context = await isolate.createContext();
    
    // 1. Inject the secure query function
    const queryRef = new ivm.Reference(secureDbQuery);
    await context.global.set(&#x27;_queryHost&#x27;, queryRef);
    
    // 2. Create a simple wrapper inside the isolate
    // This hides the complex applySync API and makes the function easy to call
    await context.eval(&#x60;
        globalThis.db = {
            query: function(sql) {
                return _queryHost.applySync(undefined, [sql], { arguments: { copy: true } });
            }
        };
    &#x60;);
    
    // 3. Run the untrusted code
    const script = await isolate.compileScript(&#x60;
        // This code can call db.query, but it NEVER sees your password
        const data = db.query(&#x22;SELECT * FROM users WHERE active = true&#x22;);
        &#x27;Found &#x27; + data.count + &#x27; active users.&#x27;;
    &#x60;);
    
    const result = await script.run(context, { timeout: 1000 });
    console.log(&#x27;üì§ Result returned to caller:&#x27;, result);
    
    isolate.dispose();
}

// Call the function
runWithDatabaseAccess();

/*
Output:
[üîê Vault] Running query with password: SELECT * FROM users WHERE active = true
üì§ Result returned to caller: Found 1 active users.
*/" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 2000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}</style></code></pre></figure>
<p><strong>The Magic:</strong></p>
<ul>
<li>The untrusted code called <code>db.query()</code> ‚úÖ</li>
<li>Your database password was <strong>never</strong> exposed to the isolate ‚úÖ</li>
<li>The actual query ran in your secure Node.js process ‚úÖ</li>
<li>Only the result was passed back ‚úÖ</li>
</ul>
<p>This is the <strong>Authenticated Object Pattern</strong> - the foundation of secure sandboxing.</p>
<hr>
<h2>üõ°Ô∏è Security Rules: What to NEVER Expose</h2>
<p>The security of this model depends entirely on what you <em>don't</em> inject. Never expose:</p>
<ul>
<li>üö´ <code>process</code> - No access to <code>env</code> or <code>exit</code></li>
<li>üö´ <code>fs</code> - No file system access</li>
<li>üö´ <code>net</code>, <code>http</code> - No raw network access (always proxy it)</li>
<li>üö´ <code>eval</code>, <code>new Function</code> - No dynamic code generation</li>
<li>üö´ <code>require</code> - No importing arbitrary modules</li>
</ul>
<p>Only expose controlled, purpose-built functions through the bridge.</p>
<h2>üéØ Summary: The Three Key Concepts</h2>
<ol>
<li><strong>V8 is the engine</strong> that compiles JavaScript into fast machine code</li>
<li><strong>V8 Isolates are sealed rooms</strong> - independent instances with their own memory and zero cross-contamination</li>
<li><strong>The Authenticated Object Pattern</strong> lets you give isolates controlled capabilities without exposing secrets</li>
</ol>
<p>This combination gives you:</p>
<ul>
<li>‚ö° <strong>Speed:</strong> Sub-5ms startup (vs. 5+ seconds for containers)</li>
<li>üîí <strong>Security:</strong> True memory isolation</li>
<li>üéõÔ∏è <strong>Control:</strong> You decide exactly what the code can access</li>
</ul>
<h2>üöÄ What's Next: Real-World Applications</h2>
<p>V8 Isolates are not just theoretical - they're the foundation of:</p>
<ul>
<li><strong>Cloudflare Workers</strong> (running millions of functions at the edge)</li>
<li><strong>Deno Deploy</strong> (secure TypeScript execution)</li>
<li><strong>Browser extensions</strong> (isolated plugin environments)</li>
<li><strong>Serverless platforms</strong> (fast, secure function execution)</li>
</ul>
<p>In <strong>Part 2 of this series</strong>, we'll explore how modern platforms use this exact architecture to run untrusted code at massive scale. We'll dive into advanced patterns like the "Code Mode" approach, where systems can execute dynamically generated code inside these secure sandboxes - including how AI agents can safely run their own code without exposing your infrastructure.</p>
<p>Now that you understand the fundamentals of V8 Isolates, you're ready to explore how they're revolutionizing everything from edge computing to AI agent architectures.</p></div></div><footer class="flex flex-col gap-6 border-t border-border pt-6"><div class="flex flex-wrap items-center gap-3"><span class="flex items-center gap-2 text-xs uppercase tracking-[0.3em] text-muted-foreground"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-share2 h-4 w-4" aria-hidden="true"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" x2="15.42" y1="13.51" y2="17.49"></line><line x1="15.41" x2="8.59" y1="6.51" y2="10.49"></line></svg>Share</span><button type="button" class="group flex h-10 w-10 items-center justify-center rounded-full border border-border transition hover:border-accent hover:bg-accent/10" aria-label="Share with device dialog"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-share2 h-4 w-4" aria-hidden="true"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" x2="15.42" y1="13.51" y2="17.49"></line><line x1="15.41" x2="8.59" y1="6.51" y2="10.49"></line></svg></button><button type="button" class="group flex h-10 w-10 items-center justify-center rounded-full border border-border transition group-hover:bg-[#0077B5] group-hover:text-white" aria-label="Share on LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-linkedin h-4 w-4" aria-hidden="true"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect width="4" height="12" x="2" y="9"></rect><circle cx="4" cy="4" r="2"></circle></svg></button><button type="button" class="group flex h-10 w-10 items-center justify-center rounded-full border border-border transition hover:border-accent hover:bg-accent/10" aria-label="Copy link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link h-4 w-4" aria-hidden="true"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button><span class="text-xs text-accent transition-opacity duration-150 opacity-0" aria-live="polite">Link copied</span></div><p class="text-sm text-muted-foreground">Enjoyed this read? Share it with your network, or reach out via the about page for collaboration or to just say hi.</p><div class="flex flex-col gap-4 border-t border-border pt-6"><p class="text-xs uppercase tracking-[0.3em] text-muted-foreground">Keep reading</p><nav class="flex flex-col items-stretch gap-3 sm:flex-row sm:items-center sm:justify-between"><a class="group inline-flex flex-1 items-center gap-2 rounded-full border border-border px-4 py-2 text-sm transition hover:border-accent hover:text-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent" href="/posts/waves-to-vectors-p1"><span aria-hidden="true">‚Üê</span><span class="flex flex-col text-left"><span class="text-[11px] uppercase tracking-widest text-muted-foreground">Previous</span><span class="font-medium text-foreground group-hover:text-accent">From Waves to Vectors: The Engineer&#x27;s Guide to Audio for AI (Part 1)</span></span></a><a class="group inline-flex flex-1 items-center justify-end gap-2 rounded-full border border-border px-4 py-2 text-sm transition hover:border-accent hover:text-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent sm:justify-end" href="/posts/ai-search-evolution"><span class="flex flex-col text-right"><span class="text-[11px] uppercase tracking-widest text-muted-foreground">Next</span><span class="font-medium text-foreground group-hover:text-accent">Beyond the Keyword: How AI Taught Search to Understand You</span></span><span aria-hidden="true">‚Üí</span></a></nav></div></footer></article><!--$--><!--/$--></main></div><script src="/_next/static/chunks/webpack-ed9be09274cd6fae.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[51458,[\"2201\",\"static/chunks/2201-6f6797369dbd70e4.js\",\"8537\",\"static/chunks/8537-401cf79acecfff54.js\",\"7394\",\"static/chunks/7394-6015a1eac3455248.js\",\"9227\",\"static/chunks/9227-702d20ddd5580687.js\",\"7177\",\"static/chunks/app/layout-5abbe08916af3e92.js\"],\"ThemeProvider\"]\n3:I[21887,[\"2201\",\"static/chunks/2201-6f6797369dbd70e4.js\",\"8537\",\"static/chunks/8537-401cf79acecfff54.js\",\"7394\",\"static/chunks/7394-6015a1eac3455248.js\",\"9227\",\"static/chunks/9227-702d20ddd5580687.js\",\"7177\",\"static/chunks/app/layout-5abbe08916af3e92.js\"],\"\"]\n4:I[79081,[\"2201\",\"static/chunks/2201-6f6797369dbd70e4.js\",\"8537\",\"static/chunks/8537-401cf79acecfff54.js\",\"7394\",\"static/chunks/7394-6015a1eac3455248.js\",\"9227\",\"static/chunks/9227-702d20ddd5580687.js\",\"7177\",\"static/chunks/app/layout-5abbe08916af3e92.js\"],\"GlobalAudioProvider\"]\n5:I[80989,[\"2201\",\"static/chunks/2201-6f6797369dbd70e4.js\",\"8537\",\"static/chunks/8537-401cf79acecfff54.js\",\"7394\",\"static/chunks/7394-6015a1eac3455248.js\",\"9227\",\"static/chunks/9227-702d20ddd5580687.js\",\"7177\",\"static/chunks/app/layout-5abbe08916af3e92.js\"],\"SearchSheetProvider\"]\n6:I[33572,[\"2201\",\"static/chunks/2201-6f6797369dbd70e4.js\",\"8537\",\"static/chunks/8537-401cf79acecfff54.js\",\"7394\",\"static/chunks/7394-6015a1eac3455248.js\",\"9227\",\"static/chunks/9227-702d20ddd5580687.js\",\"7177\",\"static/chunks/app/layout-5abbe08916af3e92.js\"],\"FloatingAudioProvider\"]\n7:I[87435,[\"2201\",\"static/chunks/2201-6f6797369dbd70e4.js\",\"8537\",\"static/chunks/8537-401cf79acecfff54.js\",\"7394\",\"static/chunks/7394-6015a1eac3455248.js\",\"9227\",\"static/chunks/9227-702d20ddd5580687.js\",\"7177\",\"static/chunks/app/layout-5abbe08916af3e92.js\"],\"FloatingNav\"]\n8:I[9766,[],\"\"]\n9:I[98924,[],\"\"]\nb:I[24431,[],\"OutletBoundary\"]\nd:I[15278,[],\"AsyncMetadataOutlet\"]\nf:I[24431,[],\"ViewportBoundary\"]\n11:I[24431,[],\"MetadataBoundary\"]\n12:\"$Sreact.suspense\"\n14:I[57150,[],\"\"]\n:HL[\"/_next/static/media/4cf2300e9c8272f7-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"cro"])</script><script>self.__next_f.push([1,"ssOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/15ff950965ac935a.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"IkZUDQEwMnrXIQxr3RMHp\",\"p\":\"\",\"c\":[\"\",\"posts\",\"v8-isolates-explainer-p1\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"v8-isolates-explainer-p1\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/15ff950965ac935a.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_188709 __variable_9a8899 min-h-screen bg-background font-sans text-foreground\",\"children\":[\"$\",\"$L2\",null,{\"children\":[[\"$\",\"$L3\",null,{\"color\":\"hsl(var(--accent))\",\"height\":3,\"showSpinner\":false}],[\"$\",\"$L4\",null,{\"children\":[\"$\",\"$L5\",null,{\"children\":[\"$\",\"$L6\",null,{\"children\":[[\"$\",\"$L7\",null,{}],[\"$\",\"div\",null,{\"className\":\"flex min-h-screen flex-col\",\"children\":[\"$\",\"main\",null,{\"className\":\"flex-1\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}]}]}]]}]}]}]]}],{\"children\":[\"posts\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"v8-isolates-explainer-p1\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$La\",null,[\"$\",\"$Lb\",null,{\"children\":[\"$Lc\",[\"$\",\"$Ld\",null,{\"promise\":\"$@e\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$Lf\",null,{\"children\":\"$L10\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$L11\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$12\",null,{\"fallback\":null,\"children\":\"$L13\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$14\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"15:I[19558,[\"2201\",\"static/chunks/2201-6f6797369dbd70e4.js\",\"1356\",\"static/chunks/1356-1fb83b63ccda55b7.js\",\"8537\",\"static/chunks/8537-401cf79acecfff54.js\",\"5858\",\"static/chunks/app/posts/%5Bslug%5D/page-16bd337e30c17cd7.js\"],\"MarkPostRead\"]\n16:I[7553,[\"2201\",\"static/chunks/2201-6f6797369dbd70e4.js\",\"1356\",\"static/chunks/1356-1fb83b63ccda55b7.js\",\"8537\",\"static/chunks/8537-401cf79acecfff54.js\",\"5858\",\"static/chunks/app/posts/%5Bslug%5D/page-16bd337e30c17cd7.js\"],\"ReadingProgress\"]\n17:I[52619,[\"2201\",\"static/chunks/2201-6f6797369dbd70e4.js\",\"1356\",\"static/chunks/1356-1fb83b63ccda55b7.js\",\"8537\",\"static/chunks/8537-401cf79acecfff54.js\",\"5858\",\"static/chunks/app/posts/%5Bslug%5D/page-16bd337e30c17cd7.js\"],\"\"]\n18:I[66078,[\"2201\",\"static/chunks/2201-6f6797369dbd70e4.js\",\"1356\",\"static/chunks/1356-1fb83b63ccda55b7.js\",\"8537\",\"static/chunks/8537-401cf79acecfff54.js\",\"5858\",\"static/chunks/app/posts/%5Bslug%5D/page-16bd337e30c17cd7.js\"],\"PostAudioPlayer\"]\n19:I[24121,[\"2201\",\"static/chunks/2201-6f6797369dbd70e4.js\",\"1356\",\"static/chunks/1356-1fb83b63ccda55b7.js\",\"8537\",\"static/chunks/8537-401cf79acecfff54.js\",\"5858\",\"static/chunks/app/posts/%5Bslug%5D/page-16bd337e30c17cd7.js\"],\"MermaidDiagrams\"]\n1a:I[57990,[\"2201\",\"static/chunks/2201-6f6797369dbd70e4.js\",\"1356\",\"static/chunks/1356-1fb83b63ccda55b7.js\",\"8537\",\"static/chunks/8537-401cf79acecfff54.js\",\"5858\",\"static/chunks/app/posts/%5Bslug%5D/page-16bd337e30c17cd7.js\"],\"ImageLightbox\"]\n1b:I[81356,[\"2201\",\"static/chunks/2201-6f6797369dbd70e4.js\",\"1356\",\"static/chunks/1356-1fb83b63ccda55b7.js\",\"8537\",\"static/chunks/8537-401cf79acecfff54.js\",\"5858\",\"static/chunks/app/posts/%5Bslug%5D/page-16bd337e30c17cd7.js\"],\"Image\"]\n1c:Tb613,"])</script><script>self.__next_f.push([1,"\u003ch1\u003ePart 1: Deep Dive into V8 and V8 Isolates - The Engine and the Sandbox\u003c/h1\u003e\n\u003cp\u003eImagine you need to run code you don't fully trust - maybe it's user-submitted plugins, third-party extensions, or dynamically generated scripts. What's stopping that code from reading your environment variables, accessing your file system, or consuming all your server's resources?\u003c/p\u003e\n\u003cp\u003eThis is the central challenge of modern computing: \u003cstrong\u003eHow do you run untrusted code safely?\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eYou could use Docker containers, but their 5-second \"cold start\" would kill your user experience. Virtual Machines are even slower. You need something that can create a \u003cstrong\u003eperfectly secure sandbox in less than 5 milliseconds\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eEnter the \u003cstrong\u003eV8 Isolate\u003c/strong\u003e - the battle-tested technology that powers Google Chrome and makes it possible to run untrusted code at massive scale, securely. This is the same technology behind platforms like \u003cstrong\u003eCloudflare Workers\u003c/strong\u003e and \u003cstrong\u003eDeno Deploy\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eThis guide explains what V8 Isolates are, how they work, and how you can use them to build secure, high-performance applications.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2\u003eüèéÔ∏è What is V8? The Engine That Powers JavaScript\u003c/h2\u003e\n\u003cp\u003eBefore we talk about \u003cem\u003eisolates\u003c/em\u003e, let's understand \u003cstrong\u003eV8\u003c/strong\u003e itself.\u003c/p\u003e\n\u003cp\u003eV8 is Google's open-source JavaScript and WebAssembly engine, written in C++. Think of it as the high-performance engine inside cars like Google Chrome and Node.js. Its job is to take human-readable JavaScript and compile it into lightning-fast machine code for your computer's processor.\u003c/p\u003e\n\u003cp\u003eEvery \u003ccode\u003econsole.log(\"hello\")\u003c/code\u003e you write goes through V8.\u003c/p\u003e\n\u003cp\u003eV8 is everywhere:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eGoogle Chrome\u003c/strong\u003e (browser)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eNode.js\u003c/strong\u003e (server)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDeno\u003c/strong\u003e (modern runtime)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCloudflare Workers\u003c/strong\u003e (edge computing)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure class=\"mermaid-diagram\"\u003e\u003cimg src=\"/diagrams/v8-isolates-explainer-p1-diagram-1.svg\" alt=\"Diagram 1\"\u003e\u003c/figure\u003e\n\u003ch3\u003eHow V8 Achieves Speed: JIT Compilation\u003c/h3\u003e\n\u003cp\u003eV8's secret weapon is \u003cstrong\u003eJust-In-Time (JIT) Compilation\u003c/strong\u003e - a clever two-stage process:\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eStage 1: Ignition (The Fast Starter)\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eWhen your code first runs, V8's interpreter \u003cstrong\u003eIgnition\u003c/strong\u003e executes it immediately\u003c/li\u003e\n\u003cli\u003eThis gives you instant startup - no waiting for compilation\u003c/li\u003e\n\u003cli\u003eThink of it as a speed reader that gets the job done quickly\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eStage 2: Turbofan (The Optimizer)\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIgnition watches your code as it runs\u003c/li\u003e\n\u003cli\u003eIf it sees a function being called repeatedly (a \"hot function\"), it calls in the specialist: \u003cstrong\u003eTurbofan\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eTurbofan is V8's optimizing compiler - it takes that hot code and recompiles it into hyper-optimized machine code\u003c/li\u003e\n\u003cli\u003eThe result? Lightning-fast execution for frequently-used code\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThis two-stage approach gives you the best of both worlds: \u003cstrong\u003efast startup\u003c/strong\u003e and \u003cstrong\u003emaximum sustained performance\u003c/strong\u003e.\u003c/p\u003e\n\u003cfigure class=\"mermaid-diagram\"\u003e\u003cimg src=\"/diagrams/v8-isolates-explainer-p1-diagram-2.svg\" alt=\"Diagram 2\"\u003e\u003c/figure\u003e\n\u003chr\u003e\n\u003ch2\u003eüö™ What is a V8 Isolate? The \"Sealed Room\" Analogy\u003c/h2\u003e\n\u003cp\u003eNow we get to the most important concept. If the V8 Engine is the motor, the \u003cstrong\u003eV8 Isolate\u003c/strong\u003e is the \u003cstrong\u003eperfectly sealed, soundproof room\u003c/strong\u003e in which that motor runs.\u003c/p\u003e\n\u003cp\u003eAn \u003cstrong\u003eIsolate\u003c/strong\u003e is an isolated, independent instance of the V8 engine.\u003c/p\u003e\n\u003cp\u003eThink of it literally as a \u003cstrong\u003esealed room\u003c/strong\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIt has its own \u003cstrong\u003eprivate memory\u003c/strong\u003e (its own heap)\u003c/li\u003e\n\u003cli\u003eIt has its own \u003cstrong\u003egarbage collector\u003c/strong\u003e (its own cleaning crew)\u003c/li\u003e\n\u003cli\u003eIt has \u003cstrong\u003ezero access\u003c/strong\u003e to the outside world\u003c/li\u003e\n\u003cli\u003eThe walls are soundproof and airtight\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eA person in one room \u003cstrong\u003ecannot\u003c/strong\u003e see, hear, or interact with a person in another room. If a program in one isolate crashes, it only affects that one \"room\" - the rest of your application keeps running perfectly.\u003c/p\u003e\n\u003ch3\u003eYou Use This Every Day: Chrome Tabs\u003c/h3\u003e\n\u003cp\u003eYou already use this technology daily. Every tab in Chrome runs in its own isolate.\u003c/p\u003e\n\u003cp\u003eWhen you have Gmail open in one tab and your bank in another, Gmail's JavaScript \u003cstrong\u003ecannot\u003c/strong\u003e access your banking tab's memory. If a malicious website crashes in tab 3, it doesn't take down Gmail and your bank.\u003c/p\u003e\n\u003cp\u003eThis is V8 Isolates in action.\u003c/p\u003e\n\u003cfigure class=\"mermaid-diagram\"\u003e\u003cimg src=\"/diagrams/v8-isolates-explainer-p1-diagram-3.svg\" alt=\"Diagram 3\"\u003e\u003c/figure\u003e\n\u003ch3\u003eWhat Makes Each Isolate \"Sealed\"?\u003c/h3\u003e\n\u003cp\u003eEach isolate has its own:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eDedicated Heap Memory\u003c/strong\u003e ‚≠ê Most Important\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eEach isolate has its own private memory space\u003c/li\u003e\n\u003cli\u003eCode in Isolate A \u003cstrong\u003ecannot\u003c/strong\u003e read or write memory from Isolate B\u003c/li\u003e\n\u003cli\u003eThis is the foundation of security\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eIndependent Garbage Collector\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eEach isolate cleans up its own memory\u003c/li\u003e\n\u003cli\u003eMemory cleanup in one isolate doesn't slow down others\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eSeparate Global Scope\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eEach isolate has its own \u003ccode\u003eglobal\u003c/code\u003e object\u003c/li\u003e\n\u003cli\u003eBuilt-in objects like \u003ccode\u003eMath\u003c/code\u003e, \u003ccode\u003eJSON\u003c/code\u003e are separate instances\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e‚ö° Why Isolates Changed Everything: The Performance Revolution\u003c/h2\u003e\n\u003cp\u003eFor years, we used \u003cstrong\u003eVirtual Machines\u003c/strong\u003e and \u003cstrong\u003eDocker containers\u003c/strong\u003e to isolate code. But they're heavy:\u003c/p\u003e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003eTechnology\u003c/th\u003e\u003cth\u003eStartup Time\u003c/th\u003e\u003cth\u003eMemory Overhead\u003c/th\u003e\u003cth\u003eGood For\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003e\u003cstrong\u003eVirtual Machines\u003c/strong\u003e\u003c/td\u003e\u003ctd\u003eSeconds\u003c/td\u003e\u003ctd\u003eVery Heavy\u003c/td\u003e\u003ctd\u003eFull OS isolation\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cstrong\u003eDocker Containers\u003c/strong\u003e\u003c/td\u003e\u003ctd\u003e500ms - 10s\u003c/td\u003e\u003ctd\u003eMedium\u003c/td\u003e\u003ctd\u003eMicroservices\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cstrong\u003eV8 Isolates\u003c/strong\u003e\u003c/td\u003e\u003ctd\u003e\u003cstrong\u003e\u0026#x3C; 5ms\u003c/strong\u003e\u003c/td\u003e\u003ctd\u003eVery Light\u003c/td\u003e\u003ctd\u003eCode execution\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\n\u003cp\u003eV8 Isolates are \u003cstrong\u003emicro-sandboxes\u003c/strong\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eNo operating system\u003c/li\u003e\n\u003cli\u003eNo filesystem\u003c/li\u003e\n\u003cli\u003eNo networking\u003c/li\u003e\n\u003cli\u003eNo environment variables\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eJust pure JavaScript execution.\u003c/p\u003e\n\u003cp\u003eThis breakthrough enabled the \u003cstrong\u003eserverless revolution\u003c/strong\u003e. Platforms like \u003cstrong\u003eCloudflare Workers\u003c/strong\u003e can run code from thousands of customers on the same machine, all completely isolated, with \u003cstrong\u003ezero cold start\u003c/strong\u003e. They spin up a new isolate for each request in under 5 milliseconds.\u003c/p\u003e\n\u003cfigure class=\"mermaid-diagram\"\u003e\u003cimg src=\"/diagrams/v8-isolates-explainer-p1-diagram-4.svg\" alt=\"Diagram 4\"\u003e\u003c/figure\u003e\n\u003chr\u003e\n\u003ch2\u003eüß™ What Happens Inside an Isolate?\u003c/h2\u003e\n\u003cp\u003eInside an isolate, you get a clean, empty JavaScript world:\u003c/p\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre tabindex=\"0\" data-language=\"javascript\" data-theme=\"github-dark-dimmed github-light\"\u003e\u003ccode data-language=\"javascript\" data-theme=\"github-dark-dimmed github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003elet\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e a \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e 10\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003elet\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e b \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e 20\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003ea \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e+\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e b; \u003c/span\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e// Works fine!\u003c/span\u003e\u003c/span\u003e\u003cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"let a = 10;\nlet b = 20;\na + b; // Works fine!\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(\u0026#x27;rehype-pretty-copied\u0026#x27;);window.setTimeout(() =\u003e this.classList.remove(\u0026#x27;rehype-pretty-copied\u0026#x27;), 2000);\"\u003e\u003cspan class=\"ready\"\u003e\u003c/span\u003e\u003cspan class=\"success\"\u003e\u003c/span\u003e\u003c/button\u003e\u003cstyle\u003e:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);\u0026 span {width: 100%;aspect-ratio: 1 / 1;}\u0026 .ready {background-image: var(--copy-icon);}\u0026 .success {display: none; background-image: var(--success-icon);}}\u0026.rehype-pretty-copied {\u0026 .success {display: block;} \u0026 .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;\u0026 .ready { display: none; }\u0026 .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover \u003e pre \u003e code button.rehype-pretty-copy {opacity: 1;}\u003c/style\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cp\u003eBut no access to:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e‚ùå \u003ccode\u003efs\u003c/code\u003e (file system)\u003c/li\u003e\n\u003cli\u003e‚ùå \u003ccode\u003eprocess\u003c/code\u003e (environment variables, exit)\u003c/li\u003e\n\u003cli\u003e‚ùå \u003ccode\u003erequire\u003c/code\u003e (importing modules)\u003c/li\u003e\n\u003cli\u003e‚ùå Any Node.js internals\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eUnless \u003cstrong\u003eyou explicitly expose them\u003c/strong\u003e using a secure bridge.\u003c/p\u003e\n\u003ch2\u003eüõ†Ô∏è Practical Guide: Building Sandboxes with \u003ccode\u003eisolated-vm\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eWhile V8 is a C++ library, the \u003cstrong\u003e\u003ccode\u003eisolated-vm\u003c/code\u003e\u003c/strong\u003e library for Node.js gives you direct access to this power.\u003c/p\u003e\n\u003cp\u003eFirst, install it:\u003c/p\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre tabindex=\"0\" data-language=\"bash\" data-theme=\"github-dark-dimmed github-light\"\u003e\u003ccode data-language=\"bash\" data-theme=\"github-dark-dimmed github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F69D50;--shiki-light:#6F42C1\"\u003enpm\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e install\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e isolated-vm\u003c/span\u003e\u003c/span\u003e\u003cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"npm install isolated-vm\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(\u0026#x27;rehype-pretty-copied\u0026#x27;);window.setTimeout(() =\u003e this.classList.remove(\u0026#x27;rehype-pretty-copied\u0026#x27;), 2000);\"\u003e\u003cspan class=\"ready\"\u003e\u003c/span\u003e\u003cspan class=\"success\"\u003e\u003c/span\u003e\u003c/button\u003e\u003cstyle\u003e:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);\u0026 span {width: 100%;aspect-ratio: 1 / 1;}\u0026 .ready {background-image: var(--copy-icon);}\u0026 .success {display: none; background-image: var(--success-icon);}}\u0026.rehype-pretty-copied {\u0026 .success {display: block;} \u0026 .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;\u0026 .ready { display: none; }\u0026 .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover \u003e pre \u003e code button.rehype-pretty-copy {opacity: 1;}\u003c/style\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cp\u003eThe fundamental security rule is simple: \u003cstrong\u003eThe isolate is a jail with zero access to your host system by default.\u003c/strong\u003e\u003c/p\u003e\n\u003ch3\u003eExample 1: Your First Sandbox with Time and Memory Limits\u003c/h3\u003e\n\u003cp\u003eThis example shows how to create a sandbox with strict resource limits. The code inside \u003cstrong\u003ecannot\u003c/strong\u003e run forever or consume unlimited memory.\u003c/p\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre tabindex=\"0\" data-language=\"javascript\" data-theme=\"github-dark-dimmed github-light\"\u003e\u003ccode data-language=\"javascript\" data-theme=\"github-dark-dimmed github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003econst\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e ivm\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003e require\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e'isolated-vm'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003easync\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e function\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003e runUntrustedScript\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F69D50;--shiki-light:#E36209\"\u003ecode\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e    // 1. Create a new Isolate with resource limits\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e    const\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e isolate\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e ivm.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003eIsolate\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e({ \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e        memoryLimit: \u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e128\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e// Max RAM consumption: 128MB\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e    }); \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e    const\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e context\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e await\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e isolate.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003ecreateContext\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e    // 2. Compile the script (LLM-generated or user-submitted code)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e    const\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e script\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e await\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e isolate.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003ecompileScript\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(code);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e    try\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e        console.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003elog\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e'--- Running Script in Sandbox ---'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e        \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e        // 3. Execute with a 1-second timeout\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e        const\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e result\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e await\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e script.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003erun\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(context, { timeout: \u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e1000\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e }); \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e        \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e        console.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003elog\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e'Result:'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e, result);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e    } \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003ecatch\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e (e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e        console.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003eerror\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e'Execution Failed:'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e, e.message); \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e    } \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003efinally\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e        isolate.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003edispose\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(); \u003c/span\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e// Always clean up the isolate\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e// Case 1: Safe code\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003econst\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e safeCode\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e `10 + 20;`\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e// Case 2: Time-out code (infinite loop)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003econst\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e maliciousCode\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e `while(true) {}`\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e// Case 3: Forbidden access attempt\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003econst\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e securityRiskCode\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e `process.env.SECRET_API_KEY;`\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003erunUntrustedScript\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(safeCode); \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e// Output: Result: 30\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003erunUntrustedScript\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(maliciousCode); \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e// Output: Execution Failed: Error: Script execution timed out.\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003erunUntrustedScript\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(securityRiskCode);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e// Output: Execution Failed: ReferenceError: process is not defined \u003c/span\u003e\u003c/span\u003e\u003cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"const ivm = require(\u0026#x27;isolated-vm\u0026#x27;);\n\nasync function runUntrustedScript(code) {\n    // 1. Create a new Isolate with resource limits\n    const isolate = new ivm.Isolate({ \n        memoryLimit: 128, // Max RAM consumption: 128MB\n    }); \n    const context = await isolate.createContext();\n\n    // 2. Compile the script (LLM-generated or user-submitted code)\n    const script = await isolate.compileScript(code);\n\n    try {\n        console.log(\u0026#x27;--- Running Script in Sandbox ---\u0026#x27;);\n        \n        // 3. Execute with a 1-second timeout\n        const result = await script.run(context, { timeout: 1000 }); \n        \n        console.log(\u0026#x27;Result:\u0026#x27;, result);\n    } catch (e) {\n        console.error(\u0026#x27;Execution Failed:\u0026#x27;, e.message); \n    } finally {\n        isolate.dispose(); // Always clean up the isolate\n    }\n}\n\n// Case 1: Safe code\nconst safeCode = \u0026#x60;10 + 20;\u0026#x60;;\n\n// Case 2: Time-out code (infinite loop)\nconst maliciousCode = \u0026#x60;while(true) {}\u0026#x60;;\n\n// Case 3: Forbidden access attempt\nconst securityRiskCode = \u0026#x60;process.env.SECRET_API_KEY;\u0026#x60;;\n\nrunUntrustedScript(safeCode); \n// Output: Result: 30\n\nrunUntrustedScript(maliciousCode); \n// Output: Execution Failed: Error: Script execution timed out.\n\nrunUntrustedScript(securityRiskCode);\n// Output: Execution Failed: ReferenceError: process is not defined \" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(\u0026#x27;rehype-pretty-copied\u0026#x27;);window.setTimeout(() =\u003e this.classList.remove(\u0026#x27;rehype-pretty-copied\u0026#x27;), 2000);\"\u003e\u003cspan class=\"ready\"\u003e\u003c/span\u003e\u003cspan class=\"success\"\u003e\u003c/span\u003e\u003c/button\u003e\u003cstyle\u003e:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);\u0026 span {width: 100%;aspect-ratio: 1 / 1;}\u0026 .ready {background-image: var(--copy-icon);}\u0026 .success {display: none; background-image: var(--success-icon);}}\u0026.rehype-pretty-copied {\u0026 .success {display: block;} \u0026 .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;\u0026 .ready { display: none; }\u0026 .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover \u003e pre \u003e code button.rehype-pretty-copy {opacity: 1;}\u003c/style\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cp\u003e\u003cstrong\u003eWhat just happened?\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe infinite loop was killed after 1 second ‚úÖ\u003c/li\u003e\n\u003cli\u003eThe attempt to access \u003ccode\u003eprocess.env\u003c/code\u003e failed because \u003ccode\u003eprocess\u003c/code\u003e doesn't exist in the isolate ‚úÖ\u003c/li\u003e\n\u003cli\u003eYour secrets are safe ‚úÖ\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eüîî The Challenge: Making Isolates Useful\u003c/h2\u003e\n\u003cp\u003eOkay, our isolate is perfectly secure. But it's \u003cem\u003etoo\u003c/em\u003e secure. It's a jail cell with nothing inside. How can the code do anything useful if it can't call a database or an API?\u003c/p\u003e\n\u003ch3\u003eThe Solution: The \"Bank Teller Window\" Pattern\u003c/h3\u003e\n\u003cp\u003eThink of it like a bank:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eYour Code (The Vault):\u003c/strong\u003e Holds all your secrets - API keys, database passwords\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eThe Isolate (The Lobby):\u003c/strong\u003e Where untrusted code runs\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eThe Bridge (The Teller Window):\u003c/strong\u003e A secure pass-through that takes requests but never exposes the vault\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe untrusted code can \"ring the bell\" (call a function), and your secure code handles it behind the scenes, passing back only the result.\u003c/p\u003e\n\u003cfigure class=\"mermaid-diagram\"\u003e\u003cimg src=\"/diagrams/v8-isolates-explainer-p1-diagram-5.svg\" alt=\"Diagram 5\"\u003e\u003c/figure\u003e\n\u003ch3\u003eExample 2: The \"Bank Teller\" in Action\u003c/h3\u003e\n\u003cp\u003eLet's build a secure database proxy. The untrusted code can query the database, but it \u003cstrong\u003enever\u003c/strong\u003e sees your connection string.\u003c/p\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre tabindex=\"0\" data-language=\"javascript\" data-theme=\"github-dark-dimmed github-light\"\u003e\u003ccode data-language=\"javascript\" data-theme=\"github-dark-dimmed github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003econst\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e ivm\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003e require\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e'isolated-vm'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e// --- HOST PROCESS (SECURE) ---\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e// This function runs on the secure host - secrets are protected here\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003efunction\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003e secureDbQuery\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F69D50;--shiki-light:#E36209\"\u003esql\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e    const\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e MY_DB_PASSWORD\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e 'super-secret-password-123'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e    console.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003elog\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e`[üîê Vault] Running query with password: ${\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003esql\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e}`\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e    // Real database query happens here with your credentials\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e    return\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e ivm.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003eExternalCopy\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e({ rows: [{ id: \u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e1\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e, name: \u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e\"Alice\"\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e }], count: \u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e1\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e }).\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003ecopyInto\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003easync\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e function\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003e runWithDatabaseAccess\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e    const\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e isolate\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e ivm.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003eIsolate\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e({ memoryLimit: \u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e128\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e });\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e    const\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e context\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e await\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e isolate.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003ecreateContext\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e    \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e    // 1. Inject the secure query function\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e    const\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e queryRef\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e ivm.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003eReference\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(secureDbQuery);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e    await\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e context.global.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003eset\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e'_queryHost'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e, queryRef);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e    \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e    // 2. Create a simple wrapper inside the isolate\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e    // This hides the complex applySync API and makes the function easy to call\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e    await\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e context.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003eeval\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e`\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e        globalThis.db = {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e            query: function(sql) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e                return _queryHost.applySync(undefined, [sql], { arguments: { copy: true } });\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e            }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e        };\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e    `\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e    \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e    // 3. Run the untrusted code\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e    const\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e script\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e await\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e isolate.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003ecompileScript\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e`\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e        // This code can call db.query, but it NEVER sees your password\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e        const data = db.query(\"SELECT * FROM users WHERE active = true\");\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e        'Found ' + data.count + ' active users.';\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e    `\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e    \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e    const\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e result\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F47067;--shiki-light:#D73A49\"\u003e await\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e script.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003erun\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(context, { timeout: \u003c/span\u003e\u003cspan style=\"--shiki-dark:#6CB6FF;--shiki-light:#005CC5\"\u003e1000\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e });\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e    console.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003elog\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#96D0FF;--shiki-light:#032F62\"\u003e'üì§ Result returned to caller:'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e, result);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e    \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e    isolate.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003edispose\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e// Call the function\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#DCBDFB;--shiki-light:#6F42C1\"\u003erunWithDatabaseAccess\u003c/span\u003e\u003cspan style=\"--shiki-dark:#ADBAC7;--shiki-light:#24292E\"\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e/*\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003eOutput:\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e[üîê Vault] Running query with password: SELECT * FROM users WHERE active = true\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003eüì§ Result returned to caller: Found 1 active users.\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#768390;--shiki-light:#6A737D\"\u003e*/\u003c/span\u003e\u003c/span\u003e\u003cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"const ivm = require(\u0026#x27;isolated-vm\u0026#x27;);\n\n// --- HOST PROCESS (SECURE) ---\n// This function runs on the secure host - secrets are protected here\nfunction secureDbQuery(sql) {\n    const MY_DB_PASSWORD = \u0026#x27;super-secret-password-123\u0026#x27;;\n    console.log(\u0026#x60;[üîê Vault] Running query with password: ${sql}\u0026#x60;);\n    // Real database query happens here with your credentials\n    return new ivm.ExternalCopy({ rows: [{ id: 1, name: \u0026#x22;Alice\u0026#x22; }], count: 1 }).copyInto();\n}\n\nasync function runWithDatabaseAccess() {\n    const isolate = new ivm.Isolate({ memoryLimit: 128 });\n    const context = await isolate.createContext();\n    \n    // 1. Inject the secure query function\n    const queryRef = new ivm.Reference(secureDbQuery);\n    await context.global.set(\u0026#x27;_queryHost\u0026#x27;, queryRef);\n    \n    // 2. Create a simple wrapper inside the isolate\n    // This hides the complex applySync API and makes the function easy to call\n    await context.eval(\u0026#x60;\n        globalThis.db = {\n            query: function(sql) {\n                return _queryHost.applySync(undefined, [sql], { arguments: { copy: true } });\n            }\n        };\n    \u0026#x60;);\n    \n    // 3. Run the untrusted code\n    const script = await isolate.compileScript(\u0026#x60;\n        // This code can call db.query, but it NEVER sees your password\n        const data = db.query(\u0026#x22;SELECT * FROM users WHERE active = true\u0026#x22;);\n        \u0026#x27;Found \u0026#x27; + data.count + \u0026#x27; active users.\u0026#x27;;\n    \u0026#x60;);\n    \n    const result = await script.run(context, { timeout: 1000 });\n    console.log(\u0026#x27;üì§ Result returned to caller:\u0026#x27;, result);\n    \n    isolate.dispose();\n}\n\n// Call the function\nrunWithDatabaseAccess();\n\n/*\nOutput:\n[üîê Vault] Running query with password: SELECT * FROM users WHERE active = true\nüì§ Result returned to caller: Found 1 active users.\n*/\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(\u0026#x27;rehype-pretty-copied\u0026#x27;);window.setTimeout(() =\u003e this.classList.remove(\u0026#x27;rehype-pretty-copied\u0026#x27;), 2000);\"\u003e\u003cspan class=\"ready\"\u003e\u003c/span\u003e\u003cspan class=\"success\"\u003e\u003c/span\u003e\u003c/button\u003e\u003cstyle\u003e:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);\u0026 span {width: 100%;aspect-ratio: 1 / 1;}\u0026 .ready {background-image: var(--copy-icon);}\u0026 .success {display: none; background-image: var(--success-icon);}}\u0026.rehype-pretty-copied {\u0026 .success {display: block;} \u0026 .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;\u0026 .ready { display: none; }\u0026 .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover \u003e pre \u003e code button.rehype-pretty-copy {opacity: 1;}\u003c/style\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cp\u003e\u003cstrong\u003eThe Magic:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe untrusted code called \u003ccode\u003edb.query()\u003c/code\u003e ‚úÖ\u003c/li\u003e\n\u003cli\u003eYour database password was \u003cstrong\u003enever\u003c/strong\u003e exposed to the isolate ‚úÖ\u003c/li\u003e\n\u003cli\u003eThe actual query ran in your secure Node.js process ‚úÖ\u003c/li\u003e\n\u003cli\u003eOnly the result was passed back ‚úÖ\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThis is the \u003cstrong\u003eAuthenticated Object Pattern\u003c/strong\u003e - the foundation of secure sandboxing.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2\u003eüõ°Ô∏è Security Rules: What to NEVER Expose\u003c/h2\u003e\n\u003cp\u003eThe security of this model depends entirely on what you \u003cem\u003edon't\u003c/em\u003e inject. Never expose:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eüö´ \u003ccode\u003eprocess\u003c/code\u003e - No access to \u003ccode\u003eenv\u003c/code\u003e or \u003ccode\u003eexit\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eüö´ \u003ccode\u003efs\u003c/code\u003e - No file system access\u003c/li\u003e\n\u003cli\u003eüö´ \u003ccode\u003enet\u003c/code\u003e, \u003ccode\u003ehttp\u003c/code\u003e - No raw network access (always proxy it)\u003c/li\u003e\n\u003cli\u003eüö´ \u003ccode\u003eeval\u003c/code\u003e, \u003ccode\u003enew Function\u003c/code\u003e - No dynamic code generation\u003c/li\u003e\n\u003cli\u003eüö´ \u003ccode\u003erequire\u003c/code\u003e - No importing arbitrary modules\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eOnly expose controlled, purpose-built functions through the bridge.\u003c/p\u003e\n\u003ch2\u003eüéØ Summary: The Three Key Concepts\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eV8 is the engine\u003c/strong\u003e that compiles JavaScript into fast machine code\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eV8 Isolates are sealed rooms\u003c/strong\u003e - independent instances with their own memory and zero cross-contamination\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eThe Authenticated Object Pattern\u003c/strong\u003e lets you give isolates controlled capabilities without exposing secrets\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThis combination gives you:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e‚ö° \u003cstrong\u003eSpeed:\u003c/strong\u003e Sub-5ms startup (vs. 5+ seconds for containers)\u003c/li\u003e\n\u003cli\u003eüîí \u003cstrong\u003eSecurity:\u003c/strong\u003e True memory isolation\u003c/li\u003e\n\u003cli\u003eüéõÔ∏è \u003cstrong\u003eControl:\u003c/strong\u003e You decide exactly what the code can access\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eüöÄ What's Next: Real-World Applications\u003c/h2\u003e\n\u003cp\u003eV8 Isolates are not just theoretical - they're the foundation of:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCloudflare Workers\u003c/strong\u003e (running millions of functions at the edge)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDeno Deploy\u003c/strong\u003e (secure TypeScript execution)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eBrowser extensions\u003c/strong\u003e (isolated plugin environments)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eServerless platforms\u003c/strong\u003e (fast, secure function execution)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIn \u003cstrong\u003ePart 2 of this series\u003c/strong\u003e, we'll explore how modern platforms use this exact architecture to run untrusted code at massive scale. We'll dive into advanced patterns like the \"Code Mode\" approach, where systems can execute dynamically generated code inside these secure sandboxes - including how AI agents can safely run their own code without exposing your infrastructure.\u003c/p\u003e\n\u003cp\u003eNow that you understand the fundamentals of V8 Isolates, you're ready to explore how they're revolutionizing everything from edge computing to AI agent architectures.\u003c/p\u003e"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"$L15\",null,{\"slug\":\"v8-isolates-explainer-p1\"}],[\"$\",\"$L16\",null,{}],[\"$\",\"article\",null,{\"className\":\"mx-auto flex w-full max-w-3xl flex-col gap-10 px-6 pt-12 pb-28\",\"children\":[[\"$\",\"nav\",null,{\"aria-label\":\"Breadcrumb\",\"children\":[\"$\",\"ol\",null,{\"className\":\"flex flex-wrap items-center gap-1 text-sm text-muted-foreground\",\"children\":[[\"$\",\"li\",\"/\",{\"className\":\"flex items-center gap-1\",\"children\":[[\"$\",\"$L17\",null,{\"href\":\"/\",\"className\":\"hover:text-accent\",\"children\":\"Home\"}],[\"$\",\"span\",null,{\"aria-hidden\":true,\"children\":\"/\"}]]}],[\"$\",\"li\",\"/#posts\",{\"className\":\"flex items-center gap-1\",\"children\":[[\"$\",\"$L17\",null,{\"href\":{\"pathname\":\"/\",\"hash\":\"posts\"},\"className\":\"hover:text-accent\",\"children\":\"Posts\"}],[\"$\",\"span\",null,{\"aria-hidden\":true,\"children\":\"/\"}]]}],[\"$\",\"li\",\"/posts/v8-isolates-explainer-p1\",{\"className\":\"flex items-center gap-1\",\"children\":[[\"$\",\"$L17\",null,{\"href\":\"/posts/v8-isolates-explainer-p1\",\"className\":\"hover:text-accent\",\"children\":\"Deep Dive into V8 and V8 Isolates: The Engine and the Sandbox (Part 1)\"}],null]}]]}]}],[\"$\",\"header\",null,{\"className\":\"space-y-4\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-xs uppercase tracking-[0.3em] text-accent\",\"children\":\"Article\"}],[\"$\",\"h1\",null,{\"className\":\"text-3xl font-semibold leading-tight sm:text-4xl\",\"children\":\"Deep Dive into V8 and V8 Isolates: The Engine and the Sandbox (Part 1)\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-wrap items-center gap-3 text-sm text-muted-foreground\",\"children\":[[\"$\",\"time\",null,{\"dateTime\":\"2025-11-18T00:00:00.000Z\",\"children\":\"Nov 18, 2025\"}],[\"$\",\"span\",null,{\"aria-hidden\":true,\"children\":\"‚Ä¢\"}],[\"$\",\"span\",null,{\"children\":\"10 min read\"}],[\"$\",\"span\",null,{\"aria-hidden\":true,\"children\":\"‚Ä¢\"}],[\"$\",\"$L17\",null,{\"href\":\"/about\",\"className\":\"font-medium text-foreground transition-colors hover:text-accent\",\"children\":\"Vinay Punera\"}],null]}],[\"$\",\"div\",null,{\"className\":\"flex flex-wrap gap-2\",\"children\":[[\"$\",\"span\",\"v8\",{\"className\":\"rounded-full border border-border px-3 py-1 text-xs uppercase tracking-wide\",\"children\":\"v8\"}],[\"$\",\"span\",\"v8-isolate\",{\"className\":\"rounded-full border border-border px-3 py-1 text-xs uppercase tracking-wide\",\"children\":\"v8-isolate\"}],[\"$\",\"span\",\"javascript\",{\"className\":\"rounded-full border border-border px-3 py-1 text-xs uppercase tracking-wide\",\"children\":\"javascript\"}],[\"$\",\"span\",\"nodejs\",{\"className\":\"rounded-full border border-border px-3 py-1 text-xs uppercase tracking-wide\",\"children\":\"nodejs\"}],[\"$\",\"span\",\"sandboxing\",{\"className\":\"rounded-full border border-border px-3 py-1 text-xs uppercase tracking-wide\",\"children\":\"sandboxing\"}],[\"$\",\"span\",\"isolated-vm\",{\"className\":\"rounded-full border border-border px-3 py-1 text-xs uppercase tracking-wide\",\"children\":\"isolated-vm\"}],[\"$\",\"span\",\"concurrency\",{\"className\":\"rounded-full border border-border px-3 py-1 text-xs uppercase tracking-wide\",\"children\":\"concurrency\"}],[\"$\",\"span\",\"memory-isolation\",{\"className\":\"rounded-full border border-border px-3 py-1 text-xs uppercase tracking-wide\",\"children\":\"memory-isolation\"}]]}]]}],[\"$\",\"$L18\",null,{\"postTitle\":\"Deep Dive into V8 and V8 Isolates: The Engine and the Sandbox (Part 1)\",\"postSlug\":\"v8-isolates-explainer-p1\",\"audio\":{\"src\":\"/audio/v8-isolates-explainer-p1.m4a\",\"title\":\"AI narration\",\"duration\":\"04:55\",\"mimeType\":\"audio/mp4\"}}],[\"$\",\"$L19\",null,{}],[\"$\",\"$L1a\",null,{}],[\"$\",\"div\",null,{\"className\":\"overflow-hidden rounded-3xl border border-border bg-muted\",\"children\":[\"$\",\"$L1b\",null,{\"src\":\"/illustrations/v8-isolate-architecture.svg\",\"alt\":\"An illustration of a main computing structure acting as a host, with several interior rooms that are clearly labeled as 'Isolates' and sealed off from each other, symbolizing concurrent execution with strong separation.\",\"width\":1200,\"height\":630,\"sizes\":\"(max-width: 768px) 100vw, 768px\",\"className\":\"h-auto w-full object-cover\",\"priority\":true,\"placeholder\":\"$undefined\",\"blurDataURL\":\"$undefined\"}]}],[\"$\",\"div\",null,{\"className\":\"prose prose-neutral dark:prose-invert max-w-none\",\"children\":[\"$\",\"div\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$1c\"}}]}],\"$L1d\"]}]]\n"])</script><script>self.__next_f.push([1,"1e:I[6023,[\"2201\",\"static/chunks/2201-6f6797369dbd70e4.js\",\"1356\",\"static/chunks/1356-1fb83b63ccda55b7.js\",\"8537\",\"static/chunks/8537-401cf79acecfff54.js\",\"5858\",\"static/chunks/app/posts/%5Bslug%5D/page-16bd337e30c17cd7.js\"],\"ShareButtons\"]\n"])</script><script>self.__next_f.push([1,"1d:[\"$\",\"footer\",null,{\"className\":\"flex flex-col gap-6 border-t border-border pt-6\",\"children\":[[\"$\",\"$L1e\",null,{\"slug\":\"v8-isolates-explainer-p1\",\"title\":\"Deep Dive into V8 and V8 Isolates: The Engine and the Sandbox (Part 1)\"}],[\"$\",\"p\",null,{\"className\":\"text-sm text-muted-foreground\",\"children\":\"Enjoyed this read? Share it with your network, or reach out via the about page for collaboration or to just say hi.\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-col gap-4 border-t border-border pt-6\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-xs uppercase tracking-[0.3em] text-muted-foreground\",\"children\":\"Keep reading\"}],[\"$\",\"nav\",null,{\"className\":\"flex flex-col items-stretch gap-3 sm:flex-row sm:items-center sm:justify-between\",\"children\":[[\"$\",\"$L17\",null,{\"href\":\"/posts/waves-to-vectors-p1\",\"className\":\"group inline-flex flex-1 items-center gap-2 rounded-full border border-border px-4 py-2 text-sm transition hover:border-accent hover:text-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent\",\"children\":[[\"$\",\"span\",null,{\"aria-hidden\":true,\"children\":\"‚Üê\"}],[\"$\",\"span\",null,{\"className\":\"flex flex-col text-left\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-[11px] uppercase tracking-widest text-muted-foreground\",\"children\":\"Previous\"}],[\"$\",\"span\",null,{\"className\":\"font-medium text-foreground group-hover:text-accent\",\"children\":\"From Waves to Vectors: The Engineer's Guide to Audio for AI (Part 1)\"}]]}]]}],[\"$\",\"$L17\",null,{\"href\":\"/posts/ai-search-evolution\",\"className\":\"group inline-flex flex-1 items-center justify-end gap-2 rounded-full border border-border px-4 py-2 text-sm transition hover:border-accent hover:text-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent sm:justify-end\",\"children\":[[\"$\",\"span\",null,{\"className\":\"flex flex-col text-right\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-[11px] uppercase tracking-widest text-muted-foreground\",\"children\":\"Next\"}],[\"$\",\"span\",null,{\"className\":\"font-medium text-foreground group-hover:text-accent\",\"children\":\"Beyond the Keyword: How AI Taught Search to Understand You\"}]]}],[\"$\",\"span\",null,{\"aria-hidden\":true,\"children\":\"‚Üí\"}]]}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"10:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\nc:null\n"])</script><script>self.__next_f.push([1,"1f:I[80622,[],\"IconMark\"]\n"])</script><script>self.__next_f.push([1,"e:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Deep Dive into V8 and V8 Isolates: The Engine and the Sandbox (Part 1)\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"V8 Isolates are the lightweight, secure containers that power modern JavaScript execution in Chrome and Node.js. This first part explains the V8 engine, the concept of memory isolation, and how to build a basic secure sandbox using the isolated-vm library in Node.js.\"}],[\"$\",\"meta\",\"2\",{\"property\":\"og:title\",\"content\":\"Deep Dive into V8 and V8 Isolates: The Engine and the Sandbox (Part 1)\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:description\",\"content\":\"V8 Isolates are the lightweight, secure containers that power modern JavaScript execution in Chrome and Node.js. This first part explains the V8 engine, the concept of memory isolation, and how to build a basic secure sandbox using the isolated-vm library in Node.js.\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:image\",\"content\":\"https://vinay.stealthbit.in/illustrations/v8-isolate-architecture.svg\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:image:width\",\"content\":\"1200\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:image:height\",\"content\":\"630\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:image:alt\",\"content\":\"An illustration of a main computing structure acting as a host, with several interior rooms that are clearly labeled as 'Isolates' and sealed off from each other, symbolizing concurrent execution with strong separation.\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"9\",{\"property\":\"article:published_time\",\"content\":\"2025-11-18T00:00:00.000Z\"}],[\"$\",\"meta\",\"10\",{\"property\":\"article:tag\",\"content\":\"v8\"}],[\"$\",\"meta\",\"11\",{\"property\":\"article:tag\",\"content\":\"v8-isolate\"}],[\"$\",\"meta\",\"12\",{\"property\":\"article:tag\",\"content\":\"javascript\"}],[\"$\",\"meta\",\"13\",{\"property\":\"article:tag\",\"content\":\"nodejs\"}],[\"$\",\"meta\",\"14\",{\"property\":\"article:tag\",\"content\":\"sandboxing\"}],[\"$\",\"meta\",\"15\",{\"property\":\"article:tag\",\"content\":\"isolated-vm\"}],[\"$\",\"meta\",\"16\",{\"property\":\"article:tag\",\"content\":\"concurrency\"}],[\"$\",\"meta\",\"17\",{\"property\":\"article:tag\",\"content\":\"memory-isolation\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"19\",{\"name\":\"twitter:title\",\"content\":\"Deep Dive into V8 and V8 Isolates: The Engine and the Sandbox (Part 1)\"}],[\"$\",\"meta\",\"20\",{\"name\":\"twitter:description\",\"content\":\"V8 Isolates are the lightweight, secure containers that power modern JavaScript execution in Chrome and Node.js. This first part explains the V8 engine, the concept of memory isolation, and how to build a basic secure sandbox using the isolated-vm library in Node.js.\"}],[\"$\",\"meta\",\"21\",{\"name\":\"twitter:image\",\"content\":\"https://vinay.stealthbit.in/illustrations/v8-isolate-architecture.svg\"}],[\"$\",\"link\",\"22\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}],[\"$\",\"link\",\"23\",{\"rel\":\"icon\",\"href\":\"/icon.svg?b0cfa693b1818954\",\"type\":\"image/svg+xml\",\"sizes\":\"any\"}],[\"$\",\"$L1f\",\"24\",{}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"13:\"$e:metadata\"\n"])</script></body></html>